ソフト名：run_Queries.jsx（0.3）
ライセンス：GNU GPLv3
　　作者：市川せうぞー／(c)2008-2009 Seuzo Ichikawa
動作環境：MacOS X10.5.7、InDesign CS4_J（6.0.2）
開発環境：Mac Pro Quad 3GHz（Intel）、ExtendScript Toolkit
開発言語：JavaScript
圧縮方法：zip
コメント：

**何をするスクリプトか？
-指定した複数のクエリを連続実行します。違うタイプの検索モードを混在できます。
-検索（置換）範囲を「選択範囲」「ストーリー」「ドキュメント」から選べます。
-クエリを使用するので、スタイルグループ内のスタイルも指定可能です。
-オブジェクト検索については未完全なサポート（検索範囲「ドキュメント」のみサポート）


**同梱ファイル2Files
-Readme.txt	このファイルです。とにかく最初によんでください。
-run_Queries.jsx	スクリプト本体です。


**使用条件
このスクリプトが正常に動作する環境は以下の通りです。Windows環境でも動作する可能性がありますが未検証です。
-MacOS X10.5.7
-InDesign CS4_J（6.0.2）


**インストール
スクリプト本体（run_Queries.jsx）を
~/Library/Preferences/Adobe InDesign/Version 6.0-J/ja_JP/Scripts/Scripts Panel/
にコピーしてください。エイリアスを入れておくだけでもかまいません。
スクリプトパレットから使用します。


**設定
０）スクリプトで使用したいクエリを設定します。クエリの保存方法は、[http://help.adobe.com/ja_JP/InDesign/6.0/WSB4D7E9CD-F741-40a0-A72A-1DB0E6089630a.html]を参照してください。
１）スクリプトパレット上で「run_Queries.jsx」を選択し、パレットメニューから「スクリプトを編集」を選びます。
２）もし「スクリプトを実行しますか？」とダイアログが出たら、「いいえ」を選択します。
３）「ExtendScript Toolkit.app」が立ち上がり、コードが表示されます。24行目付近の
>|javascript|
var my_Queries = [
["transliterate","半角カナ"],
["glyph","葛飾区"],
["text","カンマ"],
["grep","大見出し"],
["grep","中見出し"],
["grep","小見出し"],
["grep","図太字"],
];
||<
部分を書き換えます。書式は
>|javascript|
["モード", "クエリ名"],
||<
となっており、指定モードは「text」がテキスト、「grep」が正規表現、「glyph」が字形、「object」がオブジェクト、「transliterate」が文字種変換になっています。書いた順に上から実行されます。
ただし、objectモードのサポートは不完全で、ドキュメントを対象にした時にだけ有効になります。それ以外の検索範囲をobjectモードで仕様するとエラーになります。
４）書き換えが終了したら、保存して閉じます。


**使用方法
０）「ウインドウ」メニューから「スクリプティング」ー「スクリプト」を選択し、スクリプトパレットを出します。
１）「選択範囲」または「ストーリー」から検索置換したい場合は、該当範囲またストーリーの一部をテキストツールで選択しておきます。
２）スクリプトパレットから、スクリプト「run_Queries.jsx」をダブルクリックします。
３）検索範囲を「選択範囲」「ストーリー」「ドキュメント」からひとつ選び、「OK」をクリックします
４）現在の設定がダイアログで表示されるので、この設定でOKであれば「はい」をクリックします。
５）処理が始まります。


**既知の不具合、またはToDo
オブジェクト検索については未完全なサポート（検索範囲ドキュメントのみサポート）
grepモードでクエリに詳細形式を保存できないInDesignのバグをどうするか？
http://www2.rocketbbs.com/11/bbs.cgi?id=thats&mode=pickup&no=483


**免責事項
-本アプリケーションはInDesignにおける作業効率支援なのであって、処理結果を保証するものではありません。かならず確認をされることをおすすめします。
-このツールを使用する上でデータの破損などのあらゆる不具合・不利益については一切の責任を負いかねますのでご了解ください。
-このツールはすべてのMacintoshとMac OS上で動作をするという確認をとっていませんし、事実上出来ません。したがって、動作を保証するものではありません。


**ライセンス
GNU GPLv3
http://sourceforge.jp/projects/opensource/wiki/licenses%252FGNU_General_Public_License_version_3.0


**履　歴
2008-07-21	ver.0.1	とりあえず。http://d.hatena.ne.jp/seuzo/20080601/1212331508 の改良版。クエリを利用することで、モード、スタイルグループ、詳細形式を扱えるようにした。
2008-08-05	var.0.2	選択範囲がTextStyleRangeの時も正常に動作するようにした。選択範囲ダイアログで「キャンセル」をクリックした時、スクリプトが終了するようにした。
2009-05-18	ver.0.3	InDesign CS4対応。



市川せうぞー
http://www.seuzo.jp/
